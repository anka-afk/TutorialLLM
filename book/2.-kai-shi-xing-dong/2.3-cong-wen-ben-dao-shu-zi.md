# 2.3 从文本到数字

上一节我们确定了训练用的数据，大量输入输出文本的集合。

但文本是用来给人看的，而计算机中存储的都是数字。要想让计算机能够读懂文本，就需要先把它转换成数字。

最简单的转换是给每个字编一个序号，字和序号一一对应。这类似于一个字典，只要字典里面包含了所有可能出现的字，那么任何一句话就可以顺利地转译为一串数字。

在我们的案例中，为了节约空间，我并不打算用一个包含所有汉字的字典，而是用一个更小的字典，里面只包含训练数据中出现过的字。毕竟，历史上的所有古诗基本上涵盖了大部分写诗所需的字，用这些就够了。根据我的统计，训练数据中共出现了8548个不同的字，把他们按照出现的频率列出来大概长这样：

> 一，首，下，詩，題，以，用，目，寫，請，...(此处省略8528个字)，𪎭，𪑿，𪒘，𪘯，𫃷，𬄭，𬵩，𬾠，𭘵，𮜿

最热门的10个字大家都认识，但最冷门的10个字恐怕少有人能念得出来。

于是，我们可以直接根据这个字典，按照顺序给每个字赋予唯一的编号，从0直到8547。字的排序其实并不重要，无论像我这样按频率排序还是随机排都没有关系。因为这一步只是给它们一个ID，叫什么并不会影响它们在后续环节的发挥。

把这个字典应用到上节的数据上，我们就拥有了一个用数字表示的输入输出的集合。它看起来可能长这样：

> **Input1**: \[5605, 7964, 1180, ..., 5851, 544, 1310]
>
> **Output1**: 7964
>
> **Input2**: \[4875, 1984, 8347, ..., 2337, 8347, 5798]
>
> **Output2**: 1180
>
> **Input3**: \[6047, 7846, 7600, ..., 3514, 20, 2]
>
> **Output3**: 20
>
> ...

经过转译后输入输出已经完全无法理解，但我们知道，每个数字都对应着一个字，输出的那个数字恰好应该接在输入文本的最后面。

现在，训练数据终于就绪了。我们可以进入下一个也是最重要的环节——搭建AI模型。
