# 2.3 搭建模型

[1.3节](../1.-tou-nao-feng-bao/1.3-shen-jing-wang-luo.md)曾简单介绍过神经网络的概念，其中有一幅人工神经网络的示意图，读者或许并不陌生。人们经常用圆圈代表人工神经元，用线把这些圆圈连接起来，形成一层一层的结构。

不过，我们当时并没有详细说明这种神经网络模型该如何应用到具体的场景。针对我们手里现有的数据，该怎么设计模型的规格？别急，让我们先从一个简单案例看起。

读研究生的同学可能有过这种感觉，就是不知道什么时候会得到导师的表扬，也搞不清楚什么情况下会挨骂。小王同学为此吃了不少苦头，他决定找出其中的缘由。但导师的脾气阴晴不定，他发现并没有哪种因素可以决定导师的心情，似乎是各种原因交织在一起产生的结果。他相信导师不会无缘无故批评别人，这里面一定暗藏玄机。小王向我请教，我告诉他，你老师的心情肯定是一个非线性系统，你可以用神经网络来拟合这个系统。具体做法很简单，先列出你自己认为可能存在的影响因素，然后每天把这些因素记录下来，同时把老师当天的心情也记录下来。连续记录一个月，你就有了30条训练数据。然后写程序创建一个神经网络，用这些数据训练这个神经网络。到了第31天，你再用这个神经网络预测一下老师的心情，看跟实际结果能不能对的上。小王觉得这个主意非常科学，屁颠屁颠地开始着手实现。

他设计了一个三层神经网络。从第一层输入三个数，代表他认为比较重要的三个影响因素，分别是在办公室的频率、汇报的工作进展以及天气是否晴朗。我们姑且不评价这三个因素选的是否合适，小王既然这样选了自然有他的道理。每个输入都用0\~1之间的小数表示。在办公室的频率为0表示完全不去上班，1表示一天到晚一直在办公室呆着。汇报的工作进展为0表示完全没有进展，1表示远超预期进度，0.5表示符合预期。天气为0表示大雨，1表示万里无云的晴天。这三个数输入给第二层的四个神经元，计算得到四个结果。这四个结果再输入给第三层的唯一一个神经元，最后的输出用于判断老师的心情是好还是坏。当然，最后的输出也是一个0\~1之间的数，0表示小王会被老师大骂一顿，1表示老师对小王和蔼可亲。

<figure><img src="../.gitbook/assets/xiaowangtask.png" alt=""><figcaption><p>图2.1 小王用来预测老师心情的神经网络模型</p></figcaption></figure>

就这样，小王只需要每天收集三个输入以及一个输出，集满30天，就可以开始训练这个模型。神经元具体代表怎样的函数，我们仍旧不去计较。30天过后，模型训练完毕，小王就可以根据第31天的三个输入预测出老师对他的态度。后来，我没有再联系他，他也没有再找我。预测的准不准我们无从得知，但我猜是准的，因为据说他们实验室的老师后来性格收敛了许多，这里面大概有小王的功劳。

言归正传，读者应该从这个例子可以体会到如何根据特定的场景设计合适的模型结构。比如，如果小王认为有四个因素都很重要，那么输入就要变成四个，输入到中间层神经元的连接就会变得更多，每个中间层神经元需要变成4自变量1因变量的函数。此外，中间层神经元的数量其实是任意的，可以选择3个、4个乃至10个、20个。但不同的选择会导致不同的效果，至于几个更好，在试验之前是很难说的。这也说明了AI是一个实验科学，试过了才知道好不好用。

那么，这种模型结构能不能套用到我们的数据上呢？

对比一下两者的差异。小王的输入只有3个数，非常简单直接，而且每个数都有明确的含义。而我们的输入则比较奇怪，字数不固定，而且每个字对应的是一个编号，这个编号其实没有明确的含义，你不能把它解释成一个频率或概率，或任何现实世界的概念。如果不管三七二十一，强行把我们的输入替换到小王的输入，这两个问题会变得难以解决。首先，每条数据的输入长短不一，有的字数多有的字数少，这就导致无法设计一个稳定的网络结构来接收任意长度的数据。其次，我们的输入是0\~8547之间的整数，但相邻的整数并不意味着相邻的这两个字具有相似性。相比而言，小王的输入在0\~1之间的变化具有更连续的含义。

看来，小王的案例并不能直接帮助到我们，我们可能需要一些更复杂的方案来解决这个问题。
